function [DCM] = RotationMatrix321(attitude321)

DCM = zeros(3,3, length(attitude321));

for i = 1:length(attitude321)
phi = attitude321(1,i);
theta = attitude321(2,i);
psi = attitude321(3,i);


R1 = [1 0 0; 0 cos(phi) sin(phi); 0 -sin(phi) cos(phi)];
R2 = [cos(theta) 0 -sin(theta); 0 1 0; sin(theta) 0 cos(theta)];
R3 = [cos(psi) sin(psi) 0; -sin(psi) cos(psi) 0; 0 0 1];

DCM(:, :, i) = R1*R2*R3;

end

end

